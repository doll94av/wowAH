"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ie=require("axios");function le(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var ue=le(ie),h=(e=>(e.REGIONS="REGIONS",e.LOCALES="LOCALES",e.DEFAULT_LOCALES="DEFAULT_LOCALES",e.REGION_API_HOSTS="REGION_API_HOSTS",e.SC2_REALMS="SC2_REALMS",e.OAUTH_AUTHORIZE_URIS="OAUTH_AUTHORIZE_URIS",e.OAUTH_TOKEN_URIS="OAUTH_TOKEN_URIS",e.OAUTH_CHECK_TOKEN_URIS="OAUTH_CHECK_TOKEN_URIS",e))(h||{}),_=(e=>(e.us="us",e.eu="eu",e.kr="kr",e.tw="tw",e.cn="cn",e))(_||{}),a=(e=>(e[e.us=1]="us",e[e.eu=2]="eu",e[e.kr=3]="kr",e[e.tw=3]="tw",e[e.cn=5]="cn",e))(a||{}),j=(e=>(e.us="1",e.eu="2",e.kr="3",e.tw="3",e.cn="5",e))(j||{}),f=(e=>(e.en_US="en_US",e.es_MX="es_MX",e.pt_BR="pt_BR",e.en_GB="en_GB",e.es_ES="es_ES",e.fr_FR="fr_FR",e.ru_RU="ru_RU",e.de_DE="de_DE",e.pt_PT="pt_PT",e.it_IT="it_IT",e.ko_KR="ko_KR",e.zh_TW="zh_TW",e.zh_CN="zh_CN",e))(f||{}),k=(e=>(e[e.us=0]="us",e[e.eu=0]="eu",e[e.kr=0]="kr",e[e.tw=0]="tw",e[e.cn=0]="cn",e))(k||{}),v=(e=>(e[e.US=1]="US",e[e.LatAm=2]="LatAm",e[e.Europe=1]="Europe",e[e.Russia=2]="Russia",e[e.Korea=1]="Korea",e[e.Taiwan=2]="Taiwan",e[e.China=1]="China",e))(v||{}),V=(e=>(e.US="1",e.LatAm="2",e.Europe="1",e.Russia="2",e.Korea="1",e.Taiwan="2",e.China="1",e))(V||{}),O=(e=>(e.GET="GET",e.POST="POST",e))(O||{}),A=(e=>(e.us="https://us.battle.net",e.eu="https://eu.battle.net",e.kr="https://apac.battle.net",e.tw="https://apac.battle.net",e.cn="https://www.battlenet.com.cn",e))(A||{}),g=(e=>(e.us="https://us.api.blizzard.com",e.eu="https://eu.api.blizzard.com",e.kr="https://kr.api.blizzard.com",e.tw="https://tw.api.blizzard.com",e.cn="https://gateway.battlenet.com.cn",e))(g||{}),y=(e=>(e.authorize="/oauth/authorize",e.token="/oauth/token",e.checkToken="/oauth/check_token?token=",e))(y||{}),E=(e=>(e.LastModified="last-modified",e))(E||{}),b=(e=>(e[e.NotAuthorized=401]="NotAuthorized",e))(b||{}),S=(e=>(e.InvalidToken="invalid_token",e.AccessTokenInvalid="access_token_invalid",e.AccessTokenExpired="access_token_invalid",e))(S||{});const de=e=>e[0]==="/",he=e=>e.length>3,fe=[de,he],_e=e=>fe.every(t=>t(e)),ve=e=>/(?:http[s]?:\/\/)[^\s(["<,>]*\.[^\s[",><]*/gm.test(e);var pe=Object.defineProperty,B=Object.getOwnPropertySymbols,ge=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable,H=(e,t,r)=>t in e?pe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,T=(e,t)=>{for(var r in t||(t={}))ge.call(t,r)&&H(e,r,t[r]);if(B)for(var r of B(t))Re.call(t,r)&&H(e,r,t[r]);return e},ke=(e,t,r)=>new Promise((o,n)=>{var l=s=>{try{c(r.next(s))}catch(i){n(i)}},u=s=>{try{c(r.throw(s))}catch(i){n(i)}},c=s=>s.done?o(s.value):Promise.resolve(s.value).then(l,u);c((r=r.apply(e,t)).next())});const P=e=>ke(exports,null,function*(){const{uri:t,timeout:r,headers:o,params:n,data:l,auth:u}=e,c=e.method||O.GET;if(!ve(t))throw new RangeError(`'${t}' is not a valid parameter for fetchFromUri()`);const s=T(T(T(T({method:c,url:encodeURI(t),timeout:r||1e4},o&&{headers:o}),n&&{params:n}),u&&{auth:u}),l&&{data:l}),i=yield ue.default.request(s),w=i.headers[E.LastModified]?i.headers[E.LastModified]:null;return T(T({},i.data),w&&{lastModified:w})}),Ae=e=>{const{oauthUri:t,clientId:r,clientSecret:o}=e;return P({data:"grant_type=client_credentials",auth:{username:r,password:o},uri:t,method:O.POST})},Te=Object.freeze({[a.us]:k.us,[a.eu]:k.eu,[a.kr]:k.kr,[a.cn]:k.cn}),me=Object.freeze({[a.us]:Object.freeze([f.en_US,f.es_MX,f.pt_BR]),[a.eu]:Object.freeze([f.en_GB,f.es_ES,f.fr_FR,f.ru_RU,f.de_DE,f.pt_PT,f.it_IT]),[a.kr]:Object.freeze([f.ko_KR,f.zh_TW]),[a.cn]:Object.freeze([f.zh_CN])}),Oe=Object.freeze({[a.us]:Object.freeze([_.us]),[a.eu]:Object.freeze([_.eu]),[a.kr]:Object.freeze([_.kr,_.tw]),[a.cn]:Object.freeze([_.cn])}),ye=Object.freeze({[a.us]:Object.freeze([v.US,v.LatAm]),[a.eu]:Object.freeze([v.Europe,v.Russia]),[a.kr]:Object.freeze([v.Korea,v.Taiwan]),[a.cn]:Object.freeze([v.China])}),Se=Object.freeze({[a.us]:g.us,[a.eu]:g.eu,[a.kr]:[g.kr,g.tw],[a.cn]:g.cn}),L=Object.freeze({[a.us]:A.us,[a.eu]:A.eu,[a.kr]:A.kr,[a.cn]:A.cn}),U=e=>Object.freeze({[a.us]:`${L[a.us]}${e}`,[a.eu]:`${L[a.eu]}${e}`,[a.kr]:`${L[a.kr]}${e}`,[a.cn]:`${L[a.cn]}${e}`}),we=U(y.authorize),Ee=U(y.token),Le=U(y.checkToken),p={[h.REGIONS]:Oe,[h.LOCALES]:me,[h.DEFAULT_LOCALES]:Te,[h.SC2_REALMS]:ye,[h.REGION_API_HOSTS]:Se,[h.OAUTH_AUTHORIZE_URIS]:we,[h.OAUTH_TOKEN_URIS]:Ee,[h.OAUTH_CHECK_TOKEN_URIS]:Le},R=p[h.REGIONS],Ie=()=>R,be=()=>Object.keys(R).map(t=>parseInt(t,10)),Pe=()=>{const e=Object.values(R);return[].concat(...e).map(r=>r.toString())},F=e=>{const t=Object.keys(R),r=e.toString();if(!t.includes(r))throw new RangeError(`${r} is not a valid parameter for getRegionNameById()`);return R[r]},m=e=>{try{return Boolean(F(e))}catch{return!1}},$=e=>{const t=e.toLowerCase(),o=Object.keys(R).filter(l=>R[l].includes(t)),n=Number(o[0])||!1;if(!n)throw new RangeError(`"${e}" is not a valid parameter for getRegionIdByName()`);return n},G=e=>{try{return Boolean($(e))}catch{return!1}},z=(e,t)=>{const r=typeof e=="string"?e:e.toString();if(!m(r))throw new RangeError(`${r} is not a valid parameter for getConstantByRegionId(${e}, '${t}')`);return p[t][e]},Ue=(e,t)=>{if(!G(e))throw new RangeError(`${e} is not a valid parameter for getConstantByRegionName(${e}, '${t}')`);const o=$(e);return p[t][o]},N=(e,t)=>m(e)?z(e,t):Ue(e.toString(),t),$e=p[h.LOCALES],K=()=>$e,M=()=>Object.keys(f).filter(r=>Number.isNaN(Number(r))).map(r=>r.toString()),x=e=>z(e,h.LOCALES),D=e=>/^(?:[a-z]{2}_[a-z]{2})$/gi.test(e),W=e=>{if(!D(e))throw new RangeError(`${e} is not a valid parameter for validateLocale()`);const r=M().map(n=>n.toLowerCase()),o=e.toLowerCase();return r.includes(o)},ze=(e,t)=>{const r=e.toLowerCase(),o=W(r)||!1,n=t.toString(),l=m(n);if(!o)throw new RangeError(`${e} is not a valid locale parameter for isLocaleValidForRegionId()`);if(!l)throw new RangeError(`${t} is not a valid regionId parameter for isLocaleValidForRegionId()`);return x(t).map(c=>c.toLowerCase()).includes(r)},Ne=p[h.DEFAULT_LOCALES],Ce=p[h.LOCALES],q=e=>{const t=e.toString();if(!m(t))throw new RangeError(`${t} is not a valid parameter for getDefaultLocaleNameForRegionId()`);const o=Ne[t];return Ce[e][o]},je=()=>{const e=K(),t=Object.keys(e);return Object.assign({},...t.map(r=>({[r]:q(r)})))},Ve=()=>p.SC2_REALMS,Q=()=>{const e=Object.values(p.SC2_REALMS);return[].concat(...e).filter((r,o,n)=>o===n.indexOf(r))},X=e=>z(e,h.SC2_REALMS),C=e=>{const t=e.toString();return/^([1-9]{1})$/gi.test(t)},Be=e=>{if(!C(e))throw new RangeError(`${e} is not a valid parameter for validateSc2Realm()`);const r=Q(),o=typeof e=="number"?e:parseInt(e,10);return r.includes(o)},He=(e,t)=>{const r=C(e),o=t.toString(),n=m(o);if(!r)throw new RangeError(`${e} is not a valid sc2Realm parameter for isSc2RealmValidForRegionId()`);if(!n)throw new RangeError(`${t} is not a valid regionId parameter for isSc2RealmValidForRegionId()`);const l=X(t),u=typeof e=="number"?e:parseInt(e,10);return l.includes(u)},Fe=e=>{const t=N(e,h.REGION_API_HOSTS);return typeof e=="string"&&e.toLowerCase()===_.kr?t[0]:typeof e=="string"&&e.toLowerCase()===_.tw?t[1]:t},Ge=e=>N(e,h.OAUTH_CHECK_TOKEN_URIS),Ke=e=>N(e,h.OAUTH_TOKEN_URIS);var Me=(e,t,r)=>new Promise((o,n)=>{var l=s=>{try{c(r.next(s))}catch(i){n(i)}},u=s=>{try{c(r.throw(s))}catch(i){n(i)}},c=s=>s.done?o(s.value):Promise.resolve(s.value).then(l,u);c((r=r.apply(e,t)).next())});const Z=e=>Me(exports,null,function*(){const{region:t,clientId:r,clientSecret:o}=e,n=Ke(t);return(yield Ae({oauthUri:n,clientId:r,clientSecret:o})).access_token});var xe=(e,t,r)=>new Promise((o,n)=>{var l=s=>{try{c(r.next(s))}catch(i){n(i)}},u=s=>{try{c(r.throw(s))}catch(i){n(i)}},c=s=>s.done?o(s.value):Promise.resolve(s.value).then(l,u);c((r=r.apply(e,t)).next())});const J=(e,t)=>xe(exports,null,function*(){try{const o=`${Ge(e)}${t}`;return(yield P({uri:o})).error!==S.InvalidToken}catch{return!1}});var De=Object.defineProperty,Y=Object.getOwnPropertySymbols,We=Object.prototype.hasOwnProperty,qe=Object.prototype.propertyIsEnumerable,ee=(e,t,r)=>t in e?De(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,I=(e,t)=>{for(var r in t||(t={}))We.call(t,r)&&ee(e,r,t[r]);if(Y)for(var r of Y(t))qe.call(t,r)&&ee(e,r,t[r]);return e},Qe=(e,t,r)=>new Promise((o,n)=>{var l=s=>{try{c(r.next(s))}catch(i){n(i)}},u=s=>{try{c(r.throw(s))}catch(i){n(i)}},c=s=>s.done?o(s.value):Promise.resolve(s.value).then(l,u);c((r=r.apply(e,t)).next())});const te=(e,t)=>{const{region:r,endpoint:o,options:n}=e,{headers:l,params:u,timeout:c}=n;if(!_e(o))throw new RangeError(`${o} is not a valid endpoint.`);const w=`${Fe(r)}${o}`,ae={Authorization:`Bearer ${t}`},ce=I(I({},l),ae);return P(I(I({uri:w,method:O.GET,headers:ce},u&&{params:u}),c&&{timeout:c}))},Xe=e=>Qe(exports,null,function*(){var t;const{region:r,accessToken:o}=e,{validateAccessTokenOnEachQuery:n,refreshExpiredAccessToken:l,onAccessTokenExpired:u,onAccessTokenRefresh:c}=e.options;if(n&&!(yield J(r,o)))return{error:S.AccessTokenInvalid};try{return yield te(e,o)}catch(s){if(((t=s.response)==null?void 0:t.status)===b.NotAuthorized){if(u==null||u(),l){const i=yield Z(e);return c==null||c(i),te(e,i)}return Promise.resolve({error:S.AccessTokenExpired})}throw s}});class Ze{constructor(t,r){this.clientId=t,this.clientSecret=r}}var Je=(e,t,r)=>new Promise((o,n)=>{var l=s=>{try{c(r.next(s))}catch(i){n(i)}},u=s=>{try{c(r.throw(s))}catch(i){n(i)}},c=s=>s.done?o(s.value):Promise.resolve(s.value).then(l,u);c((r=r.apply(e,t)).next())});class re extends Ze{constructor(t){super(t.clientId,t.clientSecret);this.getAccessToken=()=>this.accessToken||this.setAccessToken(),this.setAccessToken=()=>Je(this,null,function*(){return this.accessToken=yield Z({region:this.region,clientId:this.clientId,clientSecret:this.clientSecret}),this.accessToken}),this.region=t.region,this.accessToken=t.accessToken||void 0}}re.validateAccessToken=(e,t)=>J(e,t);var Ye=Object.defineProperty,se=Object.getOwnPropertySymbols,et=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable,oe=(e,t,r)=>t in e?Ye(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ne=(e,t)=>{for(var r in t||(t={}))et.call(t,r)&&oe(e,r,t[r]);if(se)for(var r of se(t))tt.call(t,r)&&oe(e,r,t[r]);return e},rt=(e,t,r)=>new Promise((o,n)=>{var l=s=>{try{c(r.next(s))}catch(i){n(i)}},u=s=>{try{c(r.throw(s))}catch(i){n(i)}},c=s=>s.done?o(s.value):Promise.resolve(s.value).then(l,u);c((r=r.apply(e,t)).next())});class d extends re{constructor(t){super({region:t.region,clientId:t.clientId,clientSecret:t.clientSecret,accessToken:t.accessToken});this.query=(r,o)=>rt(this,null,function*(){return Xe({endpoint:r,region:this.region,clientId:this.clientId,clientSecret:this.clientSecret,accessToken:yield this.getAccessToken(),options:ne(ne({},this.options),o)})}),this.options={validateAccessTokenOnEachQuery:t.validateAccessTokenOnEachQuery||!1,refreshExpiredAccessToken:t.refreshExpiredAccessToken||!1,onAccessTokenExpired:t.onAccessTokenExpired||void 0,onAccessTokenRefresh:t.onAccessTokenRefresh||void 0}}}d.getAllRegions=Ie,d.getAllRegionIds=be,d.getAllRegionNames=Pe,d.getRegionNameById=F,d.validateRegionId=m,d.getRegionIdByName=$,d.validateRegionName=G,d.getAllLocales=K,d.getAllLocaleNames=M,d.getLocalesByRegionId=x,d.checkIfLocaleLooksValid=D,d.validateLocale=W,d.isLocaleValidForRegionId=ze,d.getAllSc2Realms=Ve,d.getAllAvailableSc2Realms=Q,d.getSc2RealmsByRegionId=X,d.checkIfSc2RealmLooksValid=C,d.validateSc2Realm=Be,d.isSc2RealmValidForRegionId=He,d.getDefaultLocaleNameForRegionId=q,d.getAllDefaultLocaleNames=je,exports.ApiHeaders=E,exports.BlizzAPI=d,exports.ConstantKey=h,exports.DefaultLocaleIndex=k,exports.ErrorCode=b,exports.ErrorResponseMessage=S,exports.HttpMethod=O,exports.Locale=f,exports.OAuthEndpoint=y,exports.OAuthHost=A,exports.RegionHost=g,exports.RegionId=a,exports.RegionIdAsString=j,exports.RegionName=_,exports.Sc2Realm=v,exports.Sc2RealmAsString=V;
