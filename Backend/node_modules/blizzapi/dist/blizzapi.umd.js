(function(d,y){typeof exports=="object"&&typeof module!="undefined"?y(exports,require("axios")):typeof define=="function"&&define.amd?define(["exports","axios"],y):(d=typeof globalThis!="undefined"?globalThis:d||self,y(d.BlizzAPI={},d.axios))})(this,function(d,y){"use strict";function ie(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var le=ie(y),h=(e=>(e.REGIONS="REGIONS",e.LOCALES="LOCALES",e.DEFAULT_LOCALES="DEFAULT_LOCALES",e.REGION_API_HOSTS="REGION_API_HOSTS",e.SC2_REALMS="SC2_REALMS",e.OAUTH_AUTHORIZE_URIS="OAUTH_AUTHORIZE_URIS",e.OAUTH_TOKEN_URIS="OAUTH_TOKEN_URIS",e.OAUTH_CHECK_TOKEN_URIS="OAUTH_CHECK_TOKEN_URIS",e))(h||{}),v=(e=>(e.us="us",e.eu="eu",e.kr="kr",e.tw="tw",e.cn="cn",e))(v||{}),a=(e=>(e[e.us=1]="us",e[e.eu=2]="eu",e[e.kr=3]="kr",e[e.tw=3]="tw",e[e.cn=5]="cn",e))(a||{}),B=(e=>(e.us="1",e.eu="2",e.kr="3",e.tw="3",e.cn="5",e))(B||{}),_=(e=>(e.en_US="en_US",e.es_MX="es_MX",e.pt_BR="pt_BR",e.en_GB="en_GB",e.es_ES="es_ES",e.fr_FR="fr_FR",e.ru_RU="ru_RU",e.de_DE="de_DE",e.pt_PT="pt_PT",e.it_IT="it_IT",e.ko_KR="ko_KR",e.zh_TW="zh_TW",e.zh_CN="zh_CN",e))(_||{}),T=(e=>(e[e.us=0]="us",e[e.eu=0]="eu",e[e.kr=0]="kr",e[e.tw=0]="tw",e[e.cn=0]="cn",e))(T||{}),p=(e=>(e[e.US=1]="US",e[e.LatAm=2]="LatAm",e[e.Europe=1]="Europe",e[e.Russia=2]="Russia",e[e.Korea=1]="Korea",e[e.Taiwan=2]="Taiwan",e[e.China=1]="China",e))(p||{}),H=(e=>(e.US="1",e.LatAm="2",e.Europe="1",e.Russia="2",e.Korea="1",e.Taiwan="2",e.China="1",e))(H||{}),S=(e=>(e.GET="GET",e.POST="POST",e))(S||{}),m=(e=>(e.us="https://us.battle.net",e.eu="https://eu.battle.net",e.kr="https://apac.battle.net",e.tw="https://apac.battle.net",e.cn="https://www.battlenet.com.cn",e))(m||{}),R=(e=>(e.us="https://us.api.blizzard.com",e.eu="https://eu.api.blizzard.com",e.kr="https://kr.api.blizzard.com",e.tw="https://tw.api.blizzard.com",e.cn="https://gateway.battlenet.com.cn",e))(R||{}),E=(e=>(e.authorize="/oauth/authorize",e.token="/oauth/token",e.checkToken="/oauth/check_token?token=",e))(E||{}),L=(e=>(e.LastModified="last-modified",e))(L||{}),U=(e=>(e[e.NotAuthorized=401]="NotAuthorized",e))(U||{}),w=(e=>(e.InvalidToken="invalid_token",e.AccessTokenInvalid="access_token_invalid",e.AccessTokenExpired="access_token_invalid",e))(w||{});const ue=[e=>e[0]==="/",e=>e.length>3],de=e=>ue.every(t=>t(e)),fe=e=>/(?:http[s]?:\/\/)[^\s(["<,>]*\.[^\s[",><]*/gm.test(e);var he=Object.defineProperty,F=Object.getOwnPropertySymbols,_e=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable,G=(e,t,r)=>t in e?he(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,A=(e,t)=>{for(var r in t||(t={}))_e.call(t,r)&&G(e,r,t[r]);if(F)for(var r of F(t))ve.call(t,r)&&G(e,r,t[r]);return e},pe=(e,t,r)=>new Promise((s,o)=>{var l=n=>{try{c(r.next(n))}catch(i){o(i)}},u=n=>{try{c(r.throw(n))}catch(i){o(i)}},c=n=>n.done?s(n.value):Promise.resolve(n.value).then(l,u);c((r=r.apply(e,t)).next())});const $=e=>pe(this,null,function*(){const{uri:t,timeout:r,headers:s,params:o,data:l,auth:u}=e,c=e.method||S.GET;if(!fe(t))throw new RangeError(`'${t}' is not a valid parameter for fetchFromUri()`);const n=A(A(A(A({method:c,url:encodeURI(t),timeout:r||1e4},s&&{headers:s}),o&&{params:o}),u&&{auth:u}),l&&{data:l}),i=yield le.default.request(n),P=i.headers[L.LastModified]?i.headers[L.LastModified]:null;return A(A({},i.data),P&&{lastModified:P})}),ge=e=>{const{oauthUri:t,clientId:r,clientSecret:s}=e;return $({data:"grant_type=client_credentials",auth:{username:r,password:s},uri:t,method:S.POST})},Re=Object.freeze({[a.us]:T.us,[a.eu]:T.eu,[a.kr]:T.kr,[a.cn]:T.cn}),ke=Object.freeze({[a.us]:Object.freeze([_.en_US,_.es_MX,_.pt_BR]),[a.eu]:Object.freeze([_.en_GB,_.es_ES,_.fr_FR,_.ru_RU,_.de_DE,_.pt_PT,_.it_IT]),[a.kr]:Object.freeze([_.ko_KR,_.zh_TW]),[a.cn]:Object.freeze([_.zh_CN])}),Te=Object.freeze({[a.us]:Object.freeze([v.us]),[a.eu]:Object.freeze([v.eu]),[a.kr]:Object.freeze([v.kr,v.tw]),[a.cn]:Object.freeze([v.cn])}),me=Object.freeze({[a.us]:Object.freeze([p.US,p.LatAm]),[a.eu]:Object.freeze([p.Europe,p.Russia]),[a.kr]:Object.freeze([p.Korea,p.Taiwan]),[a.cn]:Object.freeze([p.China])}),Ae=Object.freeze({[a.us]:R.us,[a.eu]:R.eu,[a.kr]:[R.kr,R.tw],[a.cn]:R.cn}),I=Object.freeze({[a.us]:m.us,[a.eu]:m.eu,[a.kr]:m.kr,[a.cn]:m.cn}),z=e=>Object.freeze({[a.us]:`${I[a.us]}${e}`,[a.eu]:`${I[a.eu]}${e}`,[a.kr]:`${I[a.kr]}${e}`,[a.cn]:`${I[a.cn]}${e}`}),Oe=z(E.authorize),ye=z(E.token),Se=z(E.checkToken),g={[h.REGIONS]:Te,[h.LOCALES]:ke,[h.DEFAULT_LOCALES]:Re,[h.SC2_REALMS]:me,[h.REGION_API_HOSTS]:Ae,[h.OAUTH_AUTHORIZE_URIS]:Oe,[h.OAUTH_TOKEN_URIS]:ye,[h.OAUTH_CHECK_TOKEN_URIS]:Se},k=g[h.REGIONS],Ee=()=>k,we=()=>Object.keys(k).map(t=>parseInt(t,10)),Le=()=>{const e=Object.values(k);return[].concat(...e).map(r=>r.toString())},K=e=>{const t=Object.keys(k),r=e.toString();if(!t.includes(r))throw new RangeError(`${r} is not a valid parameter for getRegionNameById()`);return k[r]},O=e=>{try{return Boolean(K(e))}catch{return!1}},N=e=>{const t=e.toLowerCase(),s=Object.keys(k).filter(l=>k[l].includes(t)),o=Number(s[0])||!1;if(!o)throw new RangeError(`"${e}" is not a valid parameter for getRegionIdByName()`);return o},M=e=>{try{return Boolean(N(e))}catch{return!1}},C=(e,t)=>{const r=typeof e=="string"?e:e.toString();if(!O(r))throw new RangeError(`${r} is not a valid parameter for getConstantByRegionId(${e}, '${t}')`);return g[t][e]},Ie=(e,t)=>{if(!M(e))throw new RangeError(`${e} is not a valid parameter for getConstantByRegionName(${e}, '${t}')`);const s=N(e);return g[t][s]},j=(e,t)=>O(e)?C(e,t):Ie(e.toString(),t),be=g[h.LOCALES],W=()=>be,D=()=>Object.keys(_).filter(r=>Number.isNaN(Number(r))).map(r=>r.toString()),q=e=>C(e,h.LOCALES),Q=e=>/^(?:[a-z]{2}_[a-z]{2})$/gi.test(e),X=e=>{if(!Q(e))throw new RangeError(`${e} is not a valid parameter for validateLocale()`);const r=D().map(o=>o.toLowerCase()),s=e.toLowerCase();return r.includes(s)},Pe=(e,t)=>{const r=e.toLowerCase(),s=X(r)||!1,o=t.toString(),l=O(o);if(!s)throw new RangeError(`${e} is not a valid locale parameter for isLocaleValidForRegionId()`);if(!l)throw new RangeError(`${t} is not a valid regionId parameter for isLocaleValidForRegionId()`);return q(t).map(c=>c.toLowerCase()).includes(r)},Ue=g[h.DEFAULT_LOCALES],$e=g[h.LOCALES],Z=e=>{const t=e.toString();if(!O(t))throw new RangeError(`${t} is not a valid parameter for getDefaultLocaleNameForRegionId()`);const s=Ue[t];return $e[e][s]},ze=()=>{const e=W(),t=Object.keys(e);return Object.assign({},...t.map(r=>({[r]:Z(r)})))},Ne=()=>g.SC2_REALMS,x=()=>{const e=Object.values(g.SC2_REALMS);return[].concat(...e).filter((r,s,o)=>s===o.indexOf(r))},J=e=>C(e,h.SC2_REALMS),V=e=>{const t=e.toString();return/^([1-9]{1})$/gi.test(t)},Ce=e=>{if(!V(e))throw new RangeError(`${e} is not a valid parameter for validateSc2Realm()`);const r=x(),s=typeof e=="number"?e:parseInt(e,10);return r.includes(s)},je=(e,t)=>{const r=V(e),s=t.toString(),o=O(s);if(!r)throw new RangeError(`${e} is not a valid sc2Realm parameter for isSc2RealmValidForRegionId()`);if(!o)throw new RangeError(`${t} is not a valid regionId parameter for isSc2RealmValidForRegionId()`);const l=J(t),u=typeof e=="number"?e:parseInt(e,10);return l.includes(u)},Ve=e=>{const t=j(e,h.REGION_API_HOSTS);return typeof e=="string"&&e.toLowerCase()===v.kr?t[0]:typeof e=="string"&&e.toLowerCase()===v.tw?t[1]:t},Be=e=>j(e,h.OAUTH_CHECK_TOKEN_URIS),He=e=>j(e,h.OAUTH_TOKEN_URIS);var Fe=(e,t,r)=>new Promise((s,o)=>{var l=n=>{try{c(r.next(n))}catch(i){o(i)}},u=n=>{try{c(r.throw(n))}catch(i){o(i)}},c=n=>n.done?s(n.value):Promise.resolve(n.value).then(l,u);c((r=r.apply(e,t)).next())});const Y=e=>Fe(this,null,function*(){const{region:t,clientId:r,clientSecret:s}=e,o=He(t);return(yield ge({oauthUri:o,clientId:r,clientSecret:s})).access_token});var Ge=(e,t,r)=>new Promise((s,o)=>{var l=n=>{try{c(r.next(n))}catch(i){o(i)}},u=n=>{try{c(r.throw(n))}catch(i){o(i)}},c=n=>n.done?s(n.value):Promise.resolve(n.value).then(l,u);c((r=r.apply(e,t)).next())});const ee=(e,t)=>Ge(this,null,function*(){try{const s=`${Be(e)}${t}`;return(yield $({uri:s})).error!==w.InvalidToken}catch{return!1}});var Ke=Object.defineProperty,te=Object.getOwnPropertySymbols,Me=Object.prototype.hasOwnProperty,We=Object.prototype.propertyIsEnumerable,re=(e,t,r)=>t in e?Ke(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,b=(e,t)=>{for(var r in t||(t={}))Me.call(t,r)&&re(e,r,t[r]);if(te)for(var r of te(t))We.call(t,r)&&re(e,r,t[r]);return e},De=(e,t,r)=>new Promise((s,o)=>{var l=n=>{try{c(r.next(n))}catch(i){o(i)}},u=n=>{try{c(r.throw(n))}catch(i){o(i)}},c=n=>n.done?s(n.value):Promise.resolve(n.value).then(l,u);c((r=r.apply(e,t)).next())});const ne=(e,t)=>{const{region:r,endpoint:s,options:o}=e,{headers:l,params:u,timeout:c}=o;if(!de(s))throw new RangeError(`${s} is not a valid endpoint.`);const P=`${Ve(r)}${s}`,et={Authorization:`Bearer ${t}`},tt=b(b({},l),et);return $(b(b({uri:P,method:S.GET,headers:tt},u&&{params:u}),c&&{timeout:c}))},qe=e=>De(this,null,function*(){var t;const{region:r,accessToken:s}=e,{validateAccessTokenOnEachQuery:o,refreshExpiredAccessToken:l,onAccessTokenExpired:u,onAccessTokenRefresh:c}=e.options;if(o&&!(yield ee(r,s)))return{error:w.AccessTokenInvalid};try{return yield ne(e,s)}catch(n){if(((t=n.response)==null?void 0:t.status)===U.NotAuthorized){if(u==null||u(),l){const i=yield Y(e);return c==null||c(i),ne(e,i)}return Promise.resolve({error:w.AccessTokenExpired})}throw n}});class Qe{constructor(t,r){this.clientId=t,this.clientSecret=r}}var Xe=(e,t,r)=>new Promise((s,o)=>{var l=n=>{try{c(r.next(n))}catch(i){o(i)}},u=n=>{try{c(r.throw(n))}catch(i){o(i)}},c=n=>n.done?s(n.value):Promise.resolve(n.value).then(l,u);c((r=r.apply(e,t)).next())});class se extends Qe{constructor(t){super(t.clientId,t.clientSecret);this.getAccessToken=()=>this.accessToken||this.setAccessToken(),this.setAccessToken=()=>Xe(this,null,function*(){return this.accessToken=yield Y({region:this.region,clientId:this.clientId,clientSecret:this.clientSecret}),this.accessToken}),this.region=t.region,this.accessToken=t.accessToken||void 0}}se.validateAccessToken=(e,t)=>ee(e,t);var Ze=Object.defineProperty,oe=Object.getOwnPropertySymbols,xe=Object.prototype.hasOwnProperty,Je=Object.prototype.propertyIsEnumerable,ae=(e,t,r)=>t in e?Ze(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ce=(e,t)=>{for(var r in t||(t={}))xe.call(t,r)&&ae(e,r,t[r]);if(oe)for(var r of oe(t))Je.call(t,r)&&ae(e,r,t[r]);return e},Ye=(e,t,r)=>new Promise((s,o)=>{var l=n=>{try{c(r.next(n))}catch(i){o(i)}},u=n=>{try{c(r.throw(n))}catch(i){o(i)}},c=n=>n.done?s(n.value):Promise.resolve(n.value).then(l,u);c((r=r.apply(e,t)).next())});class f extends se{constructor(t){super({region:t.region,clientId:t.clientId,clientSecret:t.clientSecret,accessToken:t.accessToken});this.query=(r,s)=>Ye(this,null,function*(){return qe({endpoint:r,region:this.region,clientId:this.clientId,clientSecret:this.clientSecret,accessToken:yield this.getAccessToken(),options:ce(ce({},this.options),s)})}),this.options={validateAccessTokenOnEachQuery:t.validateAccessTokenOnEachQuery||!1,refreshExpiredAccessToken:t.refreshExpiredAccessToken||!1,onAccessTokenExpired:t.onAccessTokenExpired||void 0,onAccessTokenRefresh:t.onAccessTokenRefresh||void 0}}}f.getAllRegions=Ee,f.getAllRegionIds=we,f.getAllRegionNames=Le,f.getRegionNameById=K,f.validateRegionId=O,f.getRegionIdByName=N,f.validateRegionName=M,f.getAllLocales=W,f.getAllLocaleNames=D,f.getLocalesByRegionId=q,f.checkIfLocaleLooksValid=Q,f.validateLocale=X,f.isLocaleValidForRegionId=Pe,f.getAllSc2Realms=Ne,f.getAllAvailableSc2Realms=x,f.getSc2RealmsByRegionId=J,f.checkIfSc2RealmLooksValid=V,f.validateSc2Realm=Ce,f.isSc2RealmValidForRegionId=je,f.getDefaultLocaleNameForRegionId=Z,f.getAllDefaultLocaleNames=ze,d.ApiHeaders=L,d.BlizzAPI=f,d.ConstantKey=h,d.DefaultLocaleIndex=T,d.ErrorCode=U,d.ErrorResponseMessage=w,d.HttpMethod=S,d.Locale=_,d.OAuthEndpoint=E,d.OAuthHost=m,d.RegionHost=R,d.RegionId=a,d.RegionIdAsString=B,d.RegionName=v,d.Sc2Realm=p,d.Sc2RealmAsString=H,Object.defineProperty(d,"__esModule",{value:!0})});
